# スクランブルモンスター Neo - ゲーム仕様書

## コンセプト
一画面で完結するモンスター育成・合体・対戦ゲーム。
行動力を消費してモンスターを捜索・合体・対戦し、ハイスコアを目指す。

## 画面構成（単一画面）

```
┌─────────────────────────────────┐
│  スクランブルモンスター Neo      │ AppBar
├─────────────────────────────────┤
│  スコア: 0      行動力: 1000    │ ステータスバー
├─────────────────────────────────┤
│  [Monster1] + [Monster2] → [Result] │ 合体プレビュー
│  キャンセル        合体(-10)    │ （合体選択時のみ表示）
├─────────────────────────────────┤
│  [M1] [M2] [M3] [M4] [M5]      │ パーティ（最大5体）
├─────────────────────────────────┤
│  モンスターを発見した！          │ イベントエリア
│  [発見したモンスター]            │
├─────────────────────────────────┤
│  捜索(-1)  合体  対戦(-5)       │ アクションボタン
└─────────────────────────────────┘
```

## リソース

| リソース | 初期値 | 説明 |
|---------|-------|------|
| スコア   | 0     | 対戦勝利・合体で獲得 |
| 行動力   | 1000  | 各行動で消費。0でゲーム終了 |

## モンスターのステータス

| ステータス | 説明 |
|-----------|------|
| Lv（レベル）| 総合的な強さの指標 |
| 魔力       | 攻撃力。バトルのダメージに影響 |
| 精神       | 防御力。被ダメージ軽減に影響 |
| 知力       | 素早さ・クリティカル率に影響 |

## モンスターの種族（6種類）

| 種族 | 特徴 | 魔力 | 精神 | 知力 |
|------|------|------|------|------|
| ファイア  | 攻撃特化 | 高 | 低 | 中 |
| アクア    | 防御特化 | 低 | 高 | 中 |
| ウィンド  | 速度特化 | 中 | 低 | 高 |
| アース    | バランス | 中 | 中 | 中 |
| ライト    | 魔攻型   | 高 | 中 | 低 |
| ダーク    | 万能型   | 中 | 中 | 中 |

## アクション

### 1. 捜索（コスト: 1行動力）
- ランダムなモンスター1体を発見
- Lv1〜5のモンスターが出現（レア度に応じた確率）
- パーティが5体未満 → 自動的にパーティに追加
- パーティが5体 → 入れ替えるか破棄するか選択

### 2. 合体（コスト: 10行動力）
- パーティから2体を選択
- プレビューで合体結果を確認
- 確定すると2体が1体の強化モンスターに変化

#### 合体計算式
```
結果Lv  = Lv1 + Lv2
結果魔力 = max(魔力1, 魔力2) + floor(min(魔力1, 魔力2) / 2)
結果精神 = max(精神1, 精神2) + ceil(min(精神1, 精神2) / 2)
結果知力 = max(知力1, 知力2) + floor(min(知力1, 知力2) / 2)
```
- 種族: 魔力が高い方の種族を継承

### 3. 対戦（コスト: 5行動力）
- パーティから1体を選択して出撃
- ランダムな敵モンスターが出現（現在スコアに応じた強さ）
- オートバトルで勝敗決定

#### バトル計算
```
攻撃力 = 魔力 × (1.0 + 知力 × 0.02)
防御力 = 精神 × 0.5
ダメージ = max(1, 攻撃力 - 相手防御力)

先攻: 知力が高い方（同値ならランダム）
HP = 精神 + Lv × 2
```
- 交互に攻撃し、先にHPが0になった方が負け
- **勝利**: スコア += 敵Lv × 10
- **敗北**: 出撃したモンスターがパーティから離脱

## ゲームフロー

```
ゲーム開始（行動力: 1000）
    ↓
 ┌→ アクション選択 ←─────────┐
 │   ├─ 捜索 → モンスター発見  │
 │   ├─ 合体 → モンスター強化  │
 │   └─ 対戦 → バトル実行     │
 │                             │
 │   行動力 > 0 ?              │
 │   ├─ Yes ──────────────────┘
 │   └─ No → ゲーム終了
 │            スコア表示
 │            リスタート
 └────────────────────────────
```

## UI/UX要件

- マテリアルデザイン準拠
- モンスターはピクセルアート風のアイコン（Flutterのカスタムペイントで描画）
- モンスター選択時にハイライト（オレンジ枠）
- 合体結果のステータスは赤字で強調表示
- アクションボタンにコスト表示
- 行動力不足時はボタンをグレーアウト

## 技術スタック

- Flutter 3.x
- 状態管理: ChangeNotifier + Provider（シンプル構成）
- ローカルストレージ: SharedPreferences（ハイスコア保存）
- アニメーション: Flutter標準のAnimationController
